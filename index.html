<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JSON to X++ DataContract Generator</title>
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      margin: 0;
      padding: 40px;
      color: #333;
    }
    .container {
      max-width: 950px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 16px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
      animation: fadeIn 0.6s ease-in-out;
    }
    h2 {
      text-align: center;
      color: #4b0082;
      margin-bottom: 20px;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
      margin-bottom: 6px;
    }
    textarea, input {
      width: 100%;
      margin-bottom: 18px;
      padding: 12px;
      font-family: monospace;
      font-size: 14px;
      border: 1px solid #ccc;
      border-radius: 8px;
      outline: none;
      transition: 0.3s;
    }
    textarea:focus, input:focus {
      border-color: #667eea;
      box-shadow: 0 0 6px rgba(102,126,234,0.6);
    }
    button {
      background: linear-gradient(90deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 15px;
      font-weight: bold;
      transition: transform 0.2s ease, background 0.3s ease;
    }
    button:hover {
      transform: translateY(-2px);
      background: linear-gradient(90deg, #5a67d8, #6b46c1);
    }
    .output-box {
      position: relative;
      margin-top: 15px;
    }
    .copy-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      background: #28a745;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
    }
    .copy-btn:hover {
      background: #218838;
    }
    pre {
      background: #1e1e1e;
      color: #f8f8f2;
      padding: 18px;
      border-radius: 10px;
      white-space: pre-wrap;
      min-height: 220px;
      overflow-x: auto;
      font-size: 14px;
    }
    /* Toast Notification */
    .toast {
      visibility: hidden;
      min-width: 200px;
      background-color: #28a745;
      color: white;
      text-align: center;
      border-radius: 6px;
      padding: 12px;
      position: fixed;
      z-index: 1000;
      bottom: 30px;
      right: 30px;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.4s, bottom 0.4s;
    }
    .toast.show {
      visibility: visible;
      opacity: 1;
      bottom: 50px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>‚ö° JSON ‚ûù X++ DataContract Generator</h2>

    <label for="jsonInput">Paste JSON:</label>
    <textarea id="jsonInput" rows="8" placeholder='{
  "Key1": "Value1",
  "Key2": 10.5,
  "Key3": 12,
  "Key4": ["ABC","DEF"]
}'></textarea>

    <label for="className">Class Name:</label>
    <input type="text" id="className" placeholder="Enter Class Name (e.g., AcxTestReqDC)" />

    <button onclick="generateClass()">üöÄ Generate Class</button>

    <h3>Generated Class:</h3>
    <div class="output-box">
      <button class="copy-btn" onclick="copyCode()">üìã Copy</button>
      <pre id="output"></pre>
    </div>
  </div>

  <div id="toast" class="toast">‚úÖ Code copied to clipboard!</div>

<!-- Footer Copywrite -->
  <footer style="text-align:center; margin-top:30px; font-size:14px; color:#fff;">
    <p>¬© Developed by <b>Er. Aryan Singh</b></p>
  </footer>

<script>
function detectType(value, rawValue) {
  if (typeof value === "string") {
    return "str";
  } else if (typeof value === "number") {
    if (rawValue.includes(".")) {
      return "real";
    }
    return Number.isInteger(value) ? "int" : "real";
  } else if (typeof value === "boolean") {
    return "boolean";
  } else if (Array.isArray(value)) {
    return "list";
  } else if (typeof value === "object" && value !== null) {
    return "class";
  }
  return "str";
}

function generateClass() {
  let jsonText = document.getElementById("jsonInput").value;
  let className = document.getElementById("className").value || "GeneratedContract";
  let output = document.getElementById("output");

  try {
    let obj = JSON.parse(jsonText);
    let fields = Object.keys(obj);

    let classCode = `[DataContract('${className}')]\nclass ${className}\n{\n`;

    fields.forEach(f => {
      let rawMatch = jsonText.match(new RegExp(`"${f}"\\s*:\\s*([^,}\\n]+)`));
      let rawValue = rawMatch ? rawMatch[1] : "";
      let type = detectType(obj[f], rawValue);
      if (type === "list") {
        classCode += `    List ${f};\n`;
      } else {
        classCode += `    ${type} ${f};\n`;
      }
    });

    classCode += `\n    // --- parm methods ---\n\n`;

    fields.forEach(f => {
      let rawMatch = jsonText.match(new RegExp(`"${f}"\\s*:\\s*([^,}\\n]+)`));
      let rawValue = rawMatch ? rawMatch[1] : "";
      let type = detectType(obj[f], rawValue);
      let methodName = "parm" + f.charAt(0).toUpperCase() + f.slice(1);

      if (type === "list") {
        if (obj[f].length > 0 && typeof obj[f][0] === "object") {
          classCode += `    [DataMemberAttribute("${f}"), AifCollectionTypeAttribute("_${f}", Types::Class, classStr(AcxTestRequestDC)),\n`;
          classCode += `     AifCollectionTypeAttribute("return", Types::Class, classStr(AcxTestRequestDC))]\n`;
          classCode += `    public List ${methodName}(List _${f} = ${f})\n    {\n`;
          classCode += `        ${f} = _${f};\n`;
          classCode += `        return ${f};\n`;
          classCode += `    }\n\n`;
        } else {
          classCode += `    [DataMemberAttribute("${f}")]\n`;
          classCode += `    public List ${methodName}(List _${f} = ${f})\n    {\n`;
          classCode += `        ${f} = _${f};\n`;
          classCode += `        return ${f};\n`;
          classCode += `    }\n\n`;
        }
      } else {
        classCode += `    [DataMemberAttribute("${f}")]\n`;
        classCode += `    public ${type} ${methodName}(${type} _${f} = ${f})\n    {\n`;
        classCode += `        ${f} = _${f};\n`;
        classCode += `        return ${f};\n`;
        classCode += `    }\n\n`;
      }
    });

    classCode += `}`;
    output.textContent = classCode;
  } catch (e) {
    output.textContent = "‚ùå Invalid JSON! Please check your input.";
  }
}

function copyCode() {
  let output = document.getElementById("output").textContent;
  if (!output.trim()) {
    alert("‚ö†Ô∏è No code to copy!");
    return;
  }
  navigator.clipboard.writeText(output).then(() => {
    let toast = document.getElementById("toast");
    toast.className = "toast show";
    setTimeout(() => { toast.className = toast.className.replace("show", ""); }, 2500);
  });
}
</script>
<!-- <footer style="position:fixed; bottom:10px; width:100%; text-align:center; font-size:14px; color:#fff;">
  <p>¬© Developed by <b>Er. Aryan Singh</b></p>
</footer> -->
</body>
</html>
